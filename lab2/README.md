# 第二次实验报告：平衡树搜索性能比较

## 实验目的
熟悉二叉搜索树以及常见的平衡树数据结构，对不同树搜索过程的时间复杂度有直观认识。

## 实验内容
1. 实现以下树结构：
   - 二叉搜索树（BST）
   - AVL树
   - 红黑树
   - 5阶B树

2. 实现基本操作：
   - 插入
   - 删除
   - 搜索

3. 性能测试：
   - 不同规模数据的插入性能比较
   - 搜索性能比较

## 实验环境
- 操作系统：Windows 10
- 编译器：g++ gcc
  ![version](../version.png)
- CPU：r5 5600
- 内存：32GB

## 数据结构设计

### 1. 二叉搜索树（BST）
- 基本节点结构：包含值、左子节点指针、右子节点指针
- 不进行平衡维护
- 适用于随机数据，但在有序数据下性能会显著下降

### 2. AVL树
- 在BST基础上增加高度信息
- 通过旋转操作维护平衡
- 保证任意节点的左右子树高度差不超过1

### 3. 红黑树
- 增加颜色属性和父节点指针
- 通过颜色变换和旋转维护平衡
- 保证从根到叶子的最长路径不超过最短路径的两倍

### 4. B树
- 每个节点可以包含多个键值
- 所有叶子节点在同一层
- 适合磁盘存储和范围查询

## 性能测试结果

### 插入性能比较（单位：秒）

| 数据规模 | BST | AVL树 | 红黑树 | B树 |
|---------|-----|-------|--------|-----|
| 1000    | 0.000659 | 0.000656 | 0.000496 | 0.000683 |
| 10000   | 0.015143 | 0.007241 | 0.005655 | 0.007498 |
| 100000  | 1.166025 | 0.091480 | 0.064284 | 0.082935 |

### 搜索性能比较（单位：秒）

| 数据规模 | BST | AVL树 | 红黑树 | B树 |
|---------|-----|-------|--------|-----|
| 1000    | 0.000020 | 0.000013 | 0.000018 | 0.000017 |
| 10000   | 0.000334 | 0.000237 | 0.000240 | 0.000209 |
| 100000  | 0.005013 | 0.005008 | 0.004997 | 0.003567 |

## 实验分析

### 1. 插入性能
- BST在小规模数据（1000个元素）下表现与其他树结构相当，但随着数据规模增大，性能急剧下降。在100000个元素时，插入时间达到1.166秒，远高于其他树结构。
- 红黑树在插入操作上表现最佳，在各个数据规模下都保持较好的性能。特别是在大规模数据（100000个元素）时，仅需0.064秒。
- AVL树和B树的插入性能相近，都明显优于BST，但略逊于红黑树。这可能是因为AVL树的平衡条件更严格，需要更多的旋转操作。

### 2. 搜索性能
- 在小规模数据下，四种树结构的搜索性能差异不大，都在毫秒级别。
- 随着数据规模增大，B树在搜索操作上的优势逐渐显现。在100000个元素的规模下，B树的搜索时间为0.003567秒，明显优于其他三种结构。
- BST、AVL树和红黑树在大规模数据的搜索性能相近，都在0.005秒左右。
- BST虽然在插入性能上表现较差，但在随机数据的搜索性能上并未显示出明显劣势，这说明测试数据的随机性有效避免了BST的最差情况。

### 3. 综合分析
1. 数据规模影响：
   - 小规模数据（1000个元素）：各种树结构性能相近，选择哪种结构影响不大
   - 中等规模（10000个元素）：平衡树结构的优势开始显现
   - 大规模数据（100000个元素）：BST的性能明显落后，平衡树结构的重要性凸显

2. 平衡维护开销：
   - AVL树的严格平衡导致插入性能略低于红黑树
   - 红黑树的松弛平衡策略在实际应用中表现最好
   - B树虽然结构复杂，但在大规模数据的搜索中表现优异

## 结论与建议

1. 使用场景建议：
   - 小规模数据（<1000）：可以使用简单的BST，实现简单，维护成本低
   - 频繁插入操作：优先选择红黑树，其插入性能最优
   - 频繁搜索操作：建议使用B树，尤其是在大规模数据场景下
   - 内存受限场景：红黑树是较好的选择，平衡性能和开销都适中

2. 性能优化方向：
   - BST可以考虑定期重平衡，避免性能退化
   - B树的阶数可以根据具体应用场景调整，以优化性能
   - 可以考虑混合策略，如在叶子节点使用不同的数据结构

## 完成时间
2024年3月25日

## 文件结构
- `tree.cpp`: 包含所有树的实现
- `main.cpp`: 测试程序入口
- `README.md`: 实验报告

